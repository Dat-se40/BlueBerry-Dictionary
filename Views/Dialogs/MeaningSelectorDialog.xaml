<Window x:Class="BlueBerryDictionary.Views.Dialogs.MeaningSelectorDialog"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Save word to My Words"
        Height="700" Width="800"
        WindowStartupLocation="CenterOwner"
        ResizeMode="CanResize"
        Background="{DynamicResource MainBackground}">

    <Border BorderBrush="{DynamicResource BorderColor}"
            BorderThickness="2"
            CornerRadius="20"
            Margin="20"
            Padding="30"
            Background="{DynamicResource CardBackground}">
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <!-- HEADER -->
            <StackPanel Grid.Row="0" Margin="0,0,0,20">
                <TextBlock Text="📚 Save word to My Words"
                           FontSize="24"
                           FontWeight="Bold"
                           Foreground="{DynamicResource TextColor}"
                           Margin="0,0,0,10"/>

                <TextBlock x:Name="WordTitleText"
                           Text="Word"
                           FontSize="32"
                           FontWeight="Bold"
                           Foreground="{DynamicResource ButtonColor}"/>

                <TextBlock x:Name="StepIndicator"
                           Text="Step 1/2: Select meaning"
                           FontSize="14"
                           FontWeight="SemiBold"
                           Opacity="0.8"
                           Foreground="{DynamicResource ButtonColor}"
                           Margin="0,10,0,0"/>
            </StackPanel>

            <!-- CONTENT -->
            <ScrollViewer Grid.Row="1" 
                          VerticalScrollBarVisibility="Auto"
                          Margin="0,0,0,20">
                <Grid>
                    <!-- STEP 1: MEANINGS -->
                    <StackPanel x:Name="MeaningsPanel">
                        <TextBlock Text="Click on the meaning you want to save:"
                                   FontSize="14"
                                   Opacity="0.8"
                                   Foreground="{DynamicResource TextColor}"
                                   Margin="0,0,0,15"/>

                        <StackPanel x:Name="MeaningsContainer"/>
                    </StackPanel>

                    <!-- STEP 2: TAGS -->
                    <StackPanel x:Name="TagsPanel" Visibility="Collapsed">
                        <!-- Selected Meaning Info -->
                        <Border Background="{DynamicResource WordItemBackground}"
                                BorderBrush="{DynamicResource BorderColor}"
                                BorderThickness="2"
                                CornerRadius="12"
                                Padding="15"
                                Margin="0,0,0,20">
                            <StackPanel Orientation="Horizontal">
                                <TextBlock Text="✅" FontSize="20" Margin="0,0,10,0"/>
                                <TextBlock x:Name="SelectedMeaningText"
                                           Text="Selected meaning"
                                           FontSize="14"
                                           FontWeight="SemiBold"
                                           Foreground="{DynamicResource TextColor}"
                                           VerticalAlignment="Center"/>
                            </StackPanel>
                        </Border>

                        <!-- Tags Selection -->
                        <TextBlock Text="Select a tag for this word (optional):"
                                   FontSize="14"
                                   Opacity="0.8"
                                   Foreground="{DynamicResource TextColor}"
                                   Margin="0,0,0,15"/>

                        <WrapPanel x:Name="TagsContainer"/>
                    </StackPanel>
                </Grid>
            </ScrollViewer>

            <!-- FOOTER -->
            <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Right">
                <!-- Back Button (only in step 2) -->
                <Button x:Name="BackButton"
                        Content="⬅️ Go Back"
                        Padding="20,12"
                        FontSize="14"
                        FontWeight="SemiBold"
                        Margin="0,0,10,0"
                        Click="BackButton_Click"
                        Visibility="{Binding ElementName=TagsPanel, Path=Visibility}">
                    <Button.Style>
                        <Style TargetType="Button">
                            <Setter Property="Background" Value="{DynamicResource SearchBackground}"/>
                            <Setter Property="Foreground" Value="{DynamicResource TextColor}"/>
                            <Setter Property="BorderBrush" Value="{DynamicResource BorderColor}"/>
                            <Setter Property="BorderThickness" Value="2"/>
                            <Setter Property="Cursor" Value="Hand"/>
                            <Setter Property="Template">
                                <Setter.Value>
                                    <ControlTemplate TargetType="Button">
                                        <Border Background="{TemplateBinding Background}"
                                                BorderBrush="{TemplateBinding BorderBrush}"
                                                BorderThickness="{TemplateBinding BorderThickness}"
                                                CornerRadius="12"
                                                Padding="{TemplateBinding Padding}">
                                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                        </Border>
                                    </ControlTemplate>
                                </Setter.Value>
                            </Setter>
                            <Style.Triggers>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter Property="Background" Value="{DynamicResource WordItemHover}"/>
                                </Trigger>
                            </Style.Triggers>
                        </Style>
                    </Button.Style>
                </Button>

                <!-- Skip Tags Button (only in step 2) -->
                <Button Content="⏭️ Skip"
                        Padding="20,12"
                        FontSize="14"
                        FontWeight="SemiBold"
                        Margin="0,0,10,0"
                        Click="SkipTagsButton_Click"
                        Visibility="{Binding ElementName=TagsPanel, Path=Visibility}">
                    <Button.Style>
                        <Style TargetType="Button">
                            <Setter Property="Background" Value="{DynamicResource SearchBackground}"/>
                            <Setter Property="Foreground" Value="{DynamicResource TextColor}"/>
                            <Setter Property="BorderBrush" Value="{DynamicResource BorderColor}"/>
                            <Setter Property="BorderThickness" Value="2"/>
                            <Setter Property="Cursor" Value="Hand"/>
                            <Setter Property="Template">
                                <Setter.Value>
                                    <ControlTemplate TargetType="Button">
                                        <Border Background="{TemplateBinding Background}"
                                                BorderBrush="{TemplateBinding BorderBrush}"
                                                BorderThickness="{TemplateBinding BorderThickness}"
                                                CornerRadius="12"
                                                Padding="{TemplateBinding Padding}">
                                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                        </Border>
                                    </ControlTemplate>
                                </Setter.Value>
                            </Setter>
                            <Style.Triggers>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter Property="Background" Value="{DynamicResource WordItemHover}"/>
                                </Trigger>
                            </Style.Triggers>
                        </Style>
                    </Button.Style>
                </Button>

                <!-- Cancel Button -->
                <Button Content="❌ Cancel"
                        Padding="20,12"
                        FontSize="14"
                        FontWeight="SemiBold"
                        Margin="0,0,10,0"
                        Click="CancelButton_Click">
                    <Button.Style>
                        <Style TargetType="Button">
                            <Setter Property="Background" Value="{DynamicResource SearchBackground}"/>
                            <Setter Property="Foreground" Value="#DC2626"/>
                            <Setter Property="BorderBrush" Value="#DC2626"/>
                            <Setter Property="BorderThickness" Value="2"/>
                            <Setter Property="Cursor" Value="Hand"/>
                            <Setter Property="Template">
                                <Setter.Value>
                                    <ControlTemplate TargetType="Button">
                                        <Border Background="{TemplateBinding Background}"
                                                BorderBrush="{TemplateBinding BorderBrush}"
                                                BorderThickness="{TemplateBinding BorderThickness}"
                                                CornerRadius="12"
                                                Padding="{TemplateBinding Padding}">
                                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                        </Border>
                                    </ControlTemplate>
                                </Setter.Value>
                            </Setter>
                            <Style.Triggers>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter Property="Background" Value="#DC2626"/>
                                    <Setter Property="Foreground" Value="White"/>
                                </Trigger>
                            </Style.Triggers>
                        </Style>
                    </Button.Style>
                </Button>

                <!-- Save Button (only in step 2) -->
                <Button Content="💾 Save Word"
                        Padding="20,12"
                        FontSize="14"
                        FontWeight="SemiBold"
                        Click="SaveButton_Click"
                        Visibility="{Binding ElementName=TagsPanel, Path=Visibility}">
                    <Button.Style>
                        <Style TargetType="Button">
                            <Setter Property="Background" Value="{DynamicResource ToolButtonActive}"/>
                            <Setter Property="Foreground" Value="White"/>
                            <Setter Property="BorderThickness" Value="0"/>
                            <Setter Property="Cursor" Value="Hand"/>
                            <Setter Property="Template">
                                <Setter.Value>
                                    <ControlTemplate TargetType="Button">
                                        <Border Background="{TemplateBinding Background}"
                                                CornerRadius="12"
                                                Padding="{TemplateBinding Padding}">
                                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                        </Border>
                                    </ControlTemplate>
                                </Setter.Value>
                            </Setter>
                            <Style.Triggers>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter Property="Opacity" Value="0.9"/>
                                </Trigger>
                            </Style.Triggers>
                        </Style>
                    </Button.Style>
                </Button>
            </StackPanel>
        </Grid>
    </Border>
</Window>